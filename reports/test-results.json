{"numTotalTestSuites":72,"numPassedTestSuites":71,"numFailedTestSuites":1,"numPendingTestSuites":0,"numTotalTests":119,"numPassedTests":80,"numFailedTests":39,"numPendingTests":0,"numTodoTests":0,"startTime":1757531742005,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["","ClinicSelector"],"fullName":" ClinicSelector deve renderizar combobox para admin lify","status":"failed","title":"deve renderizar combobox para admin lify","duration":25,"failureMessages":["[vitest] No \"QueryClient\" export is defined on the \"@tanstack/react-query\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":36,"column":27}},{"ancestorTitles":["","ClinicSelector"],"fullName":" ClinicSelector deve listar clínicas ativas","status":"failed","title":"deve listar clínicas ativas","duration":5,"failureMessages":["[vitest] No \"QueryClient\" export is defined on the \"@tanstack/react-query\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":36,"column":27}},{"ancestorTitles":["","ClinicSelector"],"fullName":" ClinicSelector deve permitir seleção de clínica","status":"failed","title":"deve permitir seleção de clínica","duration":2,"failureMessages":["[vitest] No \"QueryClient\" export is defined on the \"@tanstack/react-query\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":36,"column":27}},{"ancestorTitles":["","ClinicSelector"],"fullName":" ClinicSelector deve persistir seleção no localStorage","status":"failed","title":"deve persistir seleção no localStorage","duration":4,"failureMessages":["[vitest] No \"QueryClient\" export is defined on the \"@tanstack/react-query\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":36,"column":27}},{"ancestorTitles":["","ClinicSelector"],"fullName":" ClinicSelector deve carregar seleção do localStorage","status":"failed","title":"deve carregar seleção do localStorage","duration":4,"failureMessages":["[vitest] No \"QueryClient\" export is defined on the \"@tanstack/react-query\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":36,"column":27}},{"ancestorTitles":["","ClinicSelector - Permissões"],"fullName":" ClinicSelector - Permissões não deve renderizar para usuário não admin lify","status":"failed","title":"não deve renderizar para usuário não admin lify","duration":1,"failureMessages":["Cannot find module '../hooks/useAuth'\nRequire stack:\n- /Users/lucascantoni/Desktop/AtendeAí 2.0/src/tests/ClinicSelector.test.tsx"],"location":{"line":165,"column":15}}],"startTime":1757531744909,"endTime":1757531744951,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/src/tests/ClinicSelector.test.tsx"},{"assertionResults":[],"startTime":1757531742005,"endTime":1757531742005,"status":"failed","message":"  \u001b[31m×\u001b[0m Expected ';', got 'integracao'\n    ╭─[\u001b[36;1;4m/Users/lucascantoni/Desktop/AtendeAí 2.0/tests/integration/agenda_integration.simple.test.ts:80:1\u001b[0m]\n \u001b[2m77\u001b[0m │   const googleCalendar = mockUseGoogleCalendar();\n \u001b[2m78\u001b[0m │   \n \u001b[2m79\u001b[0m │   if (googleCalendar.isLoading) {\n \u001b[2m80\u001b[0m │     return <div>Carregando integracao...</div>;\n    · \u001b[35;1m                           ──────────\u001b[0m\n \u001b[2m81\u001b[0m │   }\n \u001b[2m82\u001b[0m │   \n \u001b[2m83\u001b[0m │   if (!googleCalendar.isConnected) {\n    ╰────\n\n\nCaused by:\n    Syntax Error","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/tests/integration/agenda_integration.simple.test.ts"},{"assertionResults":[{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should render agenda page with loading state","status":"failed","title":"should render agenda page with loading state","duration":26,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should render disconnected state with connect button","status":"failed","title":"should render disconnected state with connect button","duration":4,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should render connected state with calendar info","status":"failed","title":"should render connected state with calendar info","duration":4,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should handle connect button click","status":"failed","title":"should handle connect button click","duration":5,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should handle sync button click","status":"failed","title":"should handle sync button click","duration":3,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should handle disconnect button click","status":"failed","title":"should handle disconnect button click","duration":3,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should show expired status alert","status":"failed","title":"should show expired status alert","duration":3,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should show error status alert","status":"failed","title":"should show error status alert","duration":5,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}},{"ancestorTitles":["","Agenda Integration Smoke Tests"],"fullName":" Agenda Integration Smoke Tests should render calendar iframe when connected and active","status":"failed","title":"should render calendar iframe when connected and active","duration":4,"failureMessages":["[vitest] No \"BrowserRouter\" export is defined on the \"react-router-dom\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":91,"column":27}}],"startTime":1757531744296,"endTime":1757531744353,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/tests/integration/agenda_smoke.test.ts"},{"assertionResults":[{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests (Simplified) Authentication Endpoints POST /auth/login - should authenticate valid user","status":"passed","title":"POST /auth/login - should authenticate valid user","duration":2,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests (Simplified) Authentication Endpoints POST /auth/login - should reject invalid credentials","status":"failed","title":"POST /auth/login - should reject invalid credentials","duration":4,"failureMessages":["request is not defined"],"location":{"line":162,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests (Simplified) Authentication Endpoints POST /auth/login - should reject non-existent user","status":"failed","title":"POST /auth/login - should reject non-existent user","duration":2,"failureMessages":["request is not defined"],"location":{"line":176,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Token Validation"],"fullName":" Auth Service - Integration Tests (Simplified) Token Validation GET /auth/validate - should validate valid token","status":"failed","title":"GET /auth/validate - should validate valid token","duration":1,"failureMessages":["request is not defined"],"location":{"line":187,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Token Validation"],"fullName":" Auth Service - Integration Tests (Simplified) Token Validation GET /auth/validate - should reject invalid token","status":"failed","title":"GET /auth/validate - should reject invalid token","duration":1,"failureMessages":["request is not defined"],"location":{"line":197,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Token Validation"],"fullName":" Auth Service - Integration Tests (Simplified) Token Validation GET /auth/validate - should reject missing token","status":"failed","title":"GET /auth/validate - should reject missing token","duration":1,"failureMessages":["request is not defined"],"location":{"line":206,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Token Refresh"],"fullName":" Auth Service - Integration Tests (Simplified) Token Refresh POST /auth/refresh - should refresh valid token","status":"failed","title":"POST /auth/refresh - should refresh valid token","duration":2,"failureMessages":["request is not defined"],"location":{"line":216,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Token Refresh"],"fullName":" Auth Service - Integration Tests (Simplified) Token Refresh POST /auth/refresh - should reject invalid refresh token","status":"failed","title":"POST /auth/refresh - should reject invalid refresh token","duration":2,"failureMessages":["request is not defined"],"location":{"line":226,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Logout"],"fullName":" Auth Service - Integration Tests (Simplified) Logout POST /auth/logout - should logout successfully","status":"failed","title":"POST /auth/logout - should logout successfully","duration":2,"failureMessages":["request is not defined"],"location":{"line":237,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Input Validation"],"fullName":" Auth Service - Integration Tests (Simplified) Input Validation should validate email format","status":"failed","title":"should validate email format","duration":2,"failureMessages":["request is not defined"],"location":{"line":253,"column":24}},{"ancestorTitles":["","Auth Service - Integration Tests (Simplified)","Input Validation"],"fullName":" Auth Service - Integration Tests (Simplified) Input Validation should validate password length","status":"failed","title":"should validate password length","duration":1,"failureMessages":["request is not defined"],"location":{"line":267,"column":24}}],"startTime":1757531743966,"endTime":1757531743986,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/tests/integration/auth_integration.simple.test.ts"},{"assertionResults":[{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should pass basic integration test","status":"passed","title":"should pass basic integration test","duration":1,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock authentication","status":"passed","title":"should handle mock authentication","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock API response","status":"passed","title":"should handle mock API response","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock database query","status":"passed","title":"should handle mock database query","duration":2,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock service calls","status":"passed","title":"should handle mock service calls","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock React component","status":"passed","title":"should handle mock React component","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock error scenarios","status":"passed","title":"should handle mock error scenarios","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock async operations","status":"passed","title":"should handle mock async operations","duration":1,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock validation","status":"passed","title":"should handle mock validation","duration":0,"failureMessages":[]},{"ancestorTitles":["","Simple Integration Tests"],"fullName":" Simple Integration Tests should handle mock configuration","status":"passed","title":"should handle mock configuration","duration":0,"failureMessages":[]}],"startTime":1757531745015,"endTime":1757531745019,"status":"passed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/tests/integration/simple_integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","Auth Service - Integration Tests","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests Authentication Endpoints POST /auth/login - should authenticate valid user","status":"failed","title":"POST /auth/login - should authenticate valid user","duration":12,"failureMessages":["[vitest] No \"default\" export is defined on the \"bcryptjs\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":211,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests Authentication Endpoints POST /auth/login - should reject invalid credentials","status":"failed","title":"POST /auth/login - should reject invalid credentials","duration":4,"failureMessages":["[vitest] No \"default\" export is defined on the \"bcryptjs\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":246,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Authentication Endpoints"],"fullName":" Auth Service - Integration Tests Authentication Endpoints POST /auth/login - should reject non-existent user","status":"passed","title":"POST /auth/login - should reject non-existent user","duration":23,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Token Validation"],"fullName":" Auth Service - Integration Tests Token Validation GET /auth/validate - should validate valid token","status":"failed","title":"GET /auth/validate - should validate valid token","duration":3,"failureMessages":["[vitest] No \"default\" export is defined on the \"jsonwebtoken\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":292,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Token Validation"],"fullName":" Auth Service - Integration Tests Token Validation GET /auth/validate - should reject invalid token","status":"failed","title":"GET /auth/validate - should reject invalid token","duration":0,"failureMessages":["[vitest] No \"default\" export is defined on the \"jsonwebtoken\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":315,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Token Validation"],"fullName":" Auth Service - Integration Tests Token Validation GET /auth/validate - should reject missing token","status":"passed","title":"GET /auth/validate - should reject missing token","duration":8,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Token Refresh"],"fullName":" Auth Service - Integration Tests Token Refresh POST /auth/refresh - should refresh valid token","status":"failed","title":"POST /auth/refresh - should refresh valid token","duration":1,"failureMessages":["[vitest] No \"default\" export is defined on the \"jsonwebtoken\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":351,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Token Refresh"],"fullName":" Auth Service - Integration Tests Token Refresh POST /auth/refresh - should reject invalid refresh token","status":"failed","title":"POST /auth/refresh - should reject invalid refresh token","duration":1,"failureMessages":["[vitest] No \"default\" export is defined on the \"jsonwebtoken\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n"],"location":{"line":383,"column":7}},{"ancestorTitles":["","Auth Service - Integration Tests","Logout"],"fullName":" Auth Service - Integration Tests Logout POST /auth/logout - should logout successfully","status":"passed","title":"POST /auth/logout - should logout successfully","duration":9,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Rate Limiting"],"fullName":" Auth Service - Integration Tests Rate Limiting should limit login attempts","status":"passed","title":"should limit login attempts","duration":21,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Input Validation"],"fullName":" Auth Service - Integration Tests Input Validation should validate email format","status":"passed","title":"should validate email format","duration":5,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Input Validation"],"fullName":" Auth Service - Integration Tests Input Validation should validate password length","status":"passed","title":"should validate password length","duration":6,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Database Connection"],"fullName":" Auth Service - Integration Tests Database Connection should handle database connection errors gracefully","status":"passed","title":"should handle database connection errors gracefully","duration":3,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Integration Tests","Redis Connection"],"fullName":" Auth Service - Integration Tests Redis Connection should handle Redis connection errors gracefully","status":"passed","title":"should handle Redis connection errors gracefully","duration":3,"failureMessages":[]}],"startTime":1757531743342,"endTime":1757531743442,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/auth-service/tests/integration/auth.integration.test.js"},{"assertionResults":[{"ancestorTitles":["","Auth Service - Unit Tests","Password Hashing"],"fullName":" Auth Service - Unit Tests Password Hashing should hash password correctly","status":"passed","title":"should hash password correctly","duration":2,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Password Hashing"],"fullName":" Auth Service - Unit Tests Password Hashing should compare password correctly","status":"passed","title":"should compare password correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","JWT Token Generation"],"fullName":" Auth Service - Unit Tests JWT Token Generation should generate access token correctly","status":"passed","title":"should generate access token correctly","duration":2,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","JWT Token Generation"],"fullName":" Auth Service - Unit Tests JWT Token Generation should generate refresh token correctly","status":"passed","title":"should generate refresh token correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","JWT Token Generation"],"fullName":" Auth Service - Unit Tests JWT Token Generation should verify token correctly","status":"passed","title":"should verify token correctly","duration":1,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Input Validation"],"fullName":" Auth Service - Unit Tests Input Validation should validate email format","status":"passed","title":"should validate email format","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Input Validation"],"fullName":" Auth Service - Unit Tests Input Validation should validate password strength","status":"passed","title":"should validate password strength","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Error Handling"],"fullName":" Auth Service - Unit Tests Error Handling should handle validation errors","status":"passed","title":"should handle validation errors","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Error Handling"],"fullName":" Auth Service - Unit Tests Error Handling should handle JWT verification errors","status":"passed","title":"should handle JWT verification errors","duration":1,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Role Validation"],"fullName":" Auth Service - Unit Tests Role Validation should validate admin role","status":"passed","title":"should validate admin role","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Role Validation"],"fullName":" Auth Service - Unit Tests Role Validation should validate clinic admin role","status":"passed","title":"should validate clinic admin role","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Security Features"],"fullName":" Auth Service - Unit Tests Security Features should use secure JWT secret","status":"passed","title":"should use secure JWT secret","duration":1,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Security Features"],"fullName":" Auth Service - Unit Tests Security Features should use appropriate bcrypt rounds","status":"passed","title":"should use appropriate bcrypt rounds","duration":0,"failureMessages":[]},{"ancestorTitles":["","Auth Service - Unit Tests","Security Features"],"fullName":" Auth Service - Unit Tests Security Features should set appropriate token expiry","status":"passed","title":"should set appropriate token expiry","duration":1,"failureMessages":[]}],"startTime":1757531743823,"endTime":1757531743833,"status":"passed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/auth-service/tests/unit/auth.test.js"},{"assertionResults":[{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","constructor"],"fullName":" MetaAPICircuitBreaker - Simplified Tests constructor should initialize with default values","status":"passed","title":"should initialize with default values","duration":2,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","constructor"],"fullName":" MetaAPICircuitBreaker - Simplified Tests constructor should initialize with custom values","status":"passed","title":"should initialize with custom values","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","execute"],"fullName":" MetaAPICircuitBreaker - Simplified Tests execute should execute operation when circuit is CLOSED","status":"passed","title":"should execute operation when circuit is CLOSED","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","execute"],"fullName":" MetaAPICircuitBreaker - Simplified Tests execute should execute operation when circuit is HALF_OPEN","status":"passed","title":"should execute operation when circuit is HALF_OPEN","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","execute"],"fullName":" MetaAPICircuitBreaker - Simplified Tests execute should reject operation when circuit is OPEN","status":"passed","title":"should reject operation when circuit is OPEN","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","onSuccess"],"fullName":" MetaAPICircuitBreaker - Simplified Tests onSuccess should reset failure count and close circuit","status":"passed","title":"should reset failure count and close circuit","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","onFailure"],"fullName":" MetaAPICircuitBreaker - Simplified Tests onFailure should increment failure count","status":"passed","title":"should increment failure count","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","onFailure"],"fullName":" MetaAPICircuitBreaker - Simplified Tests onFailure should open circuit when failure threshold is reached","status":"passed","title":"should open circuit when failure threshold is reached","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","onFailure"],"fullName":" MetaAPICircuitBreaker - Simplified Tests onFailure should record last failure time","status":"passed","title":"should record last failure time","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","shouldAttemptReset"],"fullName":" MetaAPICircuitBreaker - Simplified Tests shouldAttemptReset should return false immediately after failure","status":"passed","title":"should return false immediately after failure","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","shouldAttemptReset"],"fullName":" MetaAPICircuitBreaker - Simplified Tests shouldAttemptReset should return true after recovery timeout","status":"passed","title":"should return true after recovery timeout","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","getState"],"fullName":" MetaAPICircuitBreaker - Simplified Tests getState should return current state","status":"passed","title":"should return current state","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker - Simplified Tests","getFailureCount"],"fullName":" MetaAPICircuitBreaker - Simplified Tests getFailureCount should return current failure count","status":"passed","title":"should return current failure count","duration":0,"failureMessages":[]}],"startTime":1757531744451,"endTime":1757531744457,"status":"passed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/tests/unit/circuitBreaker.simple.test.js"},{"assertionResults":[{"ancestorTitles":["","MetaAPICircuitBreaker","constructor"],"fullName":" MetaAPICircuitBreaker constructor should initialize with default values","status":"passed","title":"should initialize with default values","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","constructor"],"fullName":" MetaAPICircuitBreaker constructor should initialize with custom values","status":"passed","title":"should initialize with custom values","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","execute"],"fullName":" MetaAPICircuitBreaker execute should execute operation when circuit is CLOSED","status":"passed","title":"should execute operation when circuit is CLOSED","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","execute"],"fullName":" MetaAPICircuitBreaker execute should execute operation when circuit is HALF_OPEN","status":"failed","title":"should execute operation when circuit is HALF_OPEN","duration":6,"failureMessages":["Circuit breaker is OPEN"],"location":{"line":15,"column":23}},{"ancestorTitles":["","MetaAPICircuitBreaker","execute"],"fullName":" MetaAPICircuitBreaker execute should reject operation when circuit is OPEN","status":"passed","title":"should reject operation when circuit is OPEN","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","onSuccess"],"fullName":" MetaAPICircuitBreaker onSuccess should reset failure count and close circuit","status":"passed","title":"should reset failure count and close circuit","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","onFailure"],"fullName":" MetaAPICircuitBreaker onFailure should increment failure count","status":"passed","title":"should increment failure count","duration":1,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","onFailure"],"fullName":" MetaAPICircuitBreaker onFailure should open circuit when failure threshold is reached","status":"passed","title":"should open circuit when failure threshold is reached","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","onFailure"],"fullName":" MetaAPICircuitBreaker onFailure should record last failure time","status":"passed","title":"should record last failure time","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","shouldAttemptReset"],"fullName":" MetaAPICircuitBreaker shouldAttemptReset should return false immediately after failure","status":"passed","title":"should return false immediately after failure","duration":4,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","shouldAttemptReset"],"fullName":" MetaAPICircuitBreaker shouldAttemptReset should return true after recovery timeout","status":"passed","title":"should return true after recovery timeout","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","getState"],"fullName":" MetaAPICircuitBreaker getState should return current state","status":"passed","title":"should return current state","duration":0,"failureMessages":[]},{"ancestorTitles":["","MetaAPICircuitBreaker","getFailureCount"],"fullName":" MetaAPICircuitBreaker getFailureCount should return current failure count","status":"passed","title":"should return current failure count","duration":1,"failureMessages":[]}],"startTime":1757531744600,"endTime":1757531744617,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/tests/unit/circuitBreaker.test.js"},{"assertionResults":[{"ancestorTitles":["","WebhookValidator","validateVerification"],"fullName":" WebhookValidator validateVerification should validate correct verification token","status":"passed","title":"should validate correct verification token","duration":1,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","validateVerification"],"fullName":" WebhookValidator validateVerification should throw error for invalid verification token","status":"passed","title":"should throw error for invalid verification token","duration":1,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","validateVerification"],"fullName":" WebhookValidator validateVerification should throw error for non-subscribe mode","status":"passed","title":"should throw error for non-subscribe mode","duration":0,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","validateSignature"],"fullName":" WebhookValidator validateSignature should validate correct signature","status":"passed","title":"should validate correct signature","duration":1,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","validateSignature"],"fullName":" WebhookValidator validateSignature should throw error for invalid signature","status":"passed","title":"should throw error for invalid signature","duration":0,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","validateSignature"],"fullName":" WebhookValidator validateSignature should handle empty payload","status":"passed","title":"should handle empty payload","duration":0,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","generateSignature"],"fullName":" WebhookValidator generateSignature should generate consistent signature for same payload","status":"passed","title":"should generate consistent signature for same payload","duration":0,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","generateSignature"],"fullName":" WebhookValidator generateSignature should generate different signatures for different payloads","status":"passed","title":"should generate different signatures for different payloads","duration":0,"failureMessages":[]},{"ancestorTitles":["","WebhookValidator","generateSignature"],"fullName":" WebhookValidator generateSignature should generate valid hex signature","status":"passed","title":"should generate valid hex signature","duration":1,"failureMessages":[]}],"startTime":1757531744945,"endTime":1757531744950,"status":"passed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/tests/unit/webhookValidator.test.js"},{"assertionResults":[{"ancestorTitles":["","WhatsAppService - Simplified Tests","processWebhook"],"fullName":" WhatsAppService - Simplified Tests processWebhook should process webhook successfully","status":"passed","title":"should process webhook successfully","duration":6,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","processWebhook"],"fullName":" WhatsAppService - Simplified Tests processWebhook should handle errors during webhook processing","status":"passed","title":"should handle errors during webhook processing","duration":2,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","sendMessage"],"fullName":" WhatsAppService - Simplified Tests sendMessage should send message successfully","status":"passed","title":"should send message successfully","duration":1,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","processWithAI"],"fullName":" WhatsAppService - Simplified Tests processWithAI should process message with AI successfully","status":"passed","title":"should process message with AI successfully","duration":1,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","persistMessage"],"fullName":" WhatsAppService - Simplified Tests persistMessage should persist message successfully","status":"passed","title":"should persist message successfully","duration":0,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","persistMessage"],"fullName":" WhatsAppService - Simplified Tests persistMessage should handle database persistence errors","status":"passed","title":"should handle database persistence errors","duration":1,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","getClinicContext"],"fullName":" WhatsAppService - Simplified Tests getClinicContext should get clinic context successfully","status":"passed","title":"should get clinic context successfully","duration":0,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","getClinicContext"],"fullName":" WhatsAppService - Simplified Tests getClinicContext should handle clinic service errors","status":"passed","title":"should handle clinic service errors","duration":1,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","getWhatsAppConfig"],"fullName":" WhatsAppService - Simplified Tests getWhatsAppConfig should get WhatsApp config successfully","status":"passed","title":"should get WhatsApp config successfully","duration":1,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService - Simplified Tests","getWhatsAppConfig"],"fullName":" WhatsAppService - Simplified Tests getWhatsAppConfig should handle clinic service errors","status":"passed","title":"should handle clinic service errors","duration":0,"failureMessages":[]}],"startTime":1757531743160,"endTime":1757531743174,"status":"passed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/tests/unit/whatsappService.simple.test.js"},{"assertionResults":[{"ancestorTitles":["","WhatsAppService","processWebhook"],"fullName":" WhatsAppService processWebhook should process webhook successfully","status":"failed","title":"should process webhook successfully","duration":13,"failureMessages":["Failed to adapt Meta payload: Cannot read properties of undefined (reading '0')"],"location":{"line":27,"column":19}},{"ancestorTitles":["","WhatsAppService","processWebhook"],"fullName":" WhatsAppService processWebhook should handle errors during webhook processing","status":"failed","title":"should handle errors during webhook processing","duration":7,"failureMessages":["expected [Function] to throw error including 'AI processing failed' but got 'Failed to adapt Meta payload: Cannot …'"],"location":{"line":177,"column":13}},{"ancestorTitles":["","WhatsAppService","sendMessage"],"fullName":" WhatsAppService sendMessage should send message successfully","status":"failed","title":"should send message successfully","duration":2,"failureMessages":["Cannot read properties of undefined (reading 'mockResolvedValue')"],"location":{"line":203,"column":40}},{"ancestorTitles":["","WhatsAppService","processWithAI"],"fullName":" WhatsAppService processWithAI should process message with AI successfully","status":"failed","title":"should process message with AI successfully","duration":2,"failureMessages":["Cannot read properties of undefined (reading 'mockResolvedValue')"],"location":{"line":228,"column":39}},{"ancestorTitles":["","WhatsAppService","persistMessage"],"fullName":" WhatsAppService persistMessage should persist message successfully","status":"failed","title":"should persist message successfully","duration":5,"failureMessages":["Database persistence failed: Cannot find module 'pg'\nRequire stack:\n- /Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/src/config/database.js\n- /Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/src/services/whatsappService.js"],"location":{"line":104,"column":19}},{"ancestorTitles":["","WhatsAppService","persistMessage"],"fullName":" WhatsAppService persistMessage should handle database persistence errors","status":"passed","title":"should handle database persistence errors","duration":4,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService","getClinicContext"],"fullName":" WhatsAppService getClinicContext should get clinic context successfully","status":"failed","title":"should get clinic context successfully","duration":3,"failureMessages":["expected null to be { aiPersonality: 'friendly', …(1) } // Object.is equality"],"location":{"line":300,"column":28}},{"ancestorTitles":["","WhatsAppService","getClinicContext"],"fullName":" WhatsAppService getClinicContext should handle clinic service errors","status":"passed","title":"should handle clinic service errors","duration":5,"failureMessages":[]},{"ancestorTitles":["","WhatsAppService","getWhatsAppConfig"],"fullName":" WhatsAppService getWhatsAppConfig should get WhatsApp config successfully","status":"failed","title":"should get WhatsApp config successfully","duration":4,"failureMessages":["expected null to be { phoneNumber: '+5511888888888', …(1) } // Object.is equality"],"location":{"line":335,"column":28}},{"ancestorTitles":["","WhatsAppService","getWhatsAppConfig"],"fullName":" WhatsAppService getWhatsAppConfig should handle clinic service errors","status":"passed","title":"should handle clinic service errors","duration":1,"failureMessages":[]}],"startTime":1757531743184,"endTime":1757531743232,"status":"failed","message":"","name":"/Users/lucascantoni/Desktop/AtendeAí 2.0/backend/services/whatsapp-service/tests/unit/whatsappService.test.js"}]}