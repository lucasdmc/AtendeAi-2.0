{
  "name": "Appointments - Google Calendar Integration",
  "description": "Exemplos de agendamentos e integração com Google Calendar",
  "examples": [
    {
      "name": "Iniciar OAuth Google Calendar",
      "request": {
        "method": "POST",
        "url": "/google/auth",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        },
        "body": {
          "redirect_uri": "http://localhost:3000/auth/google/callback"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "auth_url": "https://accounts.google.com/o/oauth2/auth?client_id=367439444210-phr1e6oiu8hnh5vm57lpoud5lhrdda2o.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fauth%2Fgoogle%2Fcallback&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcalendar&response_type=code&access_type=offline&state=abc123def456",
          "state": "abc123def456"
        }
      }
    },
    {
      "name": "Processar Callback OAuth",
      "request": {
        "method": "POST",
        "url": "/google/callback",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        },
        "body": {
          "code": "4/0AdLIrYeP7QjKhG4uQ_yKl9G6Hh5XYZ...",
          "state": "abc123def456"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "id": "550e8400-e29b-41d4-a716-446655440060",
          "clinic_id": "550e8400-e29b-41d4-a716-446655440000",
          "calendar_id": "primary",
          "calendar_name": "Agenda Clínica Demo",
          "status": "active",
          "expires_at": "2025-01-21T16:00:00Z"
        }
      }
    },
    {
      "name": "Listar Calendários Integrados",
      "request": {
        "method": "GET",
        "url": "/google/calendars",
        "headers": {
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "response": {
        "status": 200,
        "body": [
          {
            "id": "550e8400-e29b-41d4-a716-446655440060",
            "clinic_id": "550e8400-e29b-41d4-a716-446655440000",
            "calendar_id": "primary",
            "calendar_name": "Agenda Clínica Demo",
            "status": "active",
            "expires_at": "2025-01-21T16:00:00Z"
          },
          {
            "id": "550e8400-e29b-41d4-a716-446655440061",
            "clinic_id": "550e8400-e29b-41d4-a716-446655440000",
            "calendar_id": "dr.silva@clinicademo.com",
            "calendar_name": "Dr. Silva - Consultas",
            "status": "active",
            "expires_at": "2025-01-21T16:00:00Z"
          }
        ]
      }
    },
    {
      "name": "Criar Agendamento",
      "request": {
        "method": "POST",
        "url": "/appointments",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "Idempotency-Key": "550e8400-e29b-41d4-a716-446655440070"
        },
        "body": {
          "customer_info": {
            "name": "João Silva",
            "phone": "+5511888888888",
            "email": "joao.silva@email.com"
          },
          "appointment_type": "Consulta Geral",
          "datetime": "2025-01-25T14:00:00Z",
          "duration": 30,
          "notes": "Primeira consulta - dor nas costas"
        }
      },
      "response": {
        "status": 201,
        "body": {
          "id": "550e8400-e29b-41d4-a716-446655440070",
          "clinic_id": "550e8400-e29b-41d4-a716-446655440000",
          "customer_info": {
            "name": "João Silva",
            "phone": "+5511888888888",
            "email": "joao.silva@email.com"
          },
          "google_event_id": "abc123def456ghi789",
          "appointment_type": "Consulta Geral",
          "datetime": "2025-01-25T14:00:00Z",
          "duration": 30,
          "status": "scheduled",
          "priority": 1,
          "confirmation_sent": false,
          "confirmation_received": false,
          "notes": "Primeira consulta - dor nas costas",
          "created_at": "2025-01-20T17:00:00Z",
          "updated_at": "2025-01-20T17:00:00Z"
        }
      }
    },
    {
      "name": "Listar Agendamentos",
      "request": {
        "method": "GET",
        "url": "/appointments?start_date=2025-01-25T00:00:00Z&end_date=2025-01-25T23:59:59Z&status=scheduled",
        "headers": {
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "response": {
        "status": 200,
        "body": {
          "data": [
            {
              "id": "550e8400-e29b-41d4-a716-446655440070",
              "customer_info": {
                "name": "João Silva",
                "phone": "+5511888888888"
              },
              "appointment_type": "Consulta Geral",
              "datetime": "2025-01-25T14:00:00Z",
              "duration": 30,
              "status": "scheduled",
              "priority": 1,
              "confirmation_sent": false
            },
            {
              "id": "550e8400-e29b-41d4-a716-446655440071",
              "customer_info": {
                "name": "Maria Santos",
                "phone": "+5511777777777"
              },
              "appointment_type": "Consulta de Retorno",
              "datetime": "2025-01-25T15:00:00Z",
              "duration": 20,
              "status": "confirmed",
              "priority": 2,
              "confirmation_sent": true,
              "confirmation_received": true
            }
          ],
          "pagination": {
            "page": 1,
            "limit": 20,
            "total": 2,
            "pages": 1,
            "has_next": false,
            "has_prev": false
          }
        }
      }
    },
    {
      "name": "Listar Eventos do Google Calendar",
      "request": {
        "method": "GET",
        "url": "/google/events?calendar_id=primary&start_date=2025-01-25T00:00:00Z&end_date=2025-01-25T23:59:59Z",
        "headers": {
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        }
      },
      "response": {
        "status": 200,
        "body": [
          {
            "id": "abc123def456ghi789",
            "summary": "Consulta Geral - João Silva",
            "start": {
              "dateTime": "2025-01-25T14:00:00Z",
              "timeZone": "America/Sao_Paulo"
            },
            "end": {
              "dateTime": "2025-01-25T14:30:00Z",
              "timeZone": "America/Sao_Paulo"
            },
            "status": "confirmed"
          },
          {
            "id": "def456ghi789abc123",
            "summary": "Consulta de Retorno - Maria Santos",
            "start": {
              "dateTime": "2025-01-25T15:00:00Z",
              "timeZone": "America/Sao_Paulo"
            },
            "end": {
              "dateTime": "2025-01-25T15:20:00Z",
              "timeZone": "America/Sao_Paulo"
            },
            "status": "confirmed"
          }
        ]
      }
    },
    {
      "name": "Atualizar Agendamento",
      "request": {
        "method": "PUT",
        "url": "/appointments/550e8400-e29b-41d4-a716-446655440070",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        },
        "body": {
          "datetime": "2025-01-25T15:30:00Z",
          "status": "confirmed",
          "notes": "Primeira consulta - dor nas costas. Paciente confirmou presença."
        }
      },
      "response": {
        "status": 200,
        "body": {
          "id": "550e8400-e29b-41d4-a716-446655440070",
          "datetime": "2025-01-25T15:30:00Z",
          "status": "confirmed",
          "confirmation_received": true,
          "notes": "Primeira consulta - dor nas costas. Paciente confirmou presença.",
          "updated_at": "2025-01-20T18:00:00Z"
        }
      }
    },
    {
      "name": "Erro - Conflito de Agendamento",
      "request": {
        "method": "POST",
        "url": "/appointments",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        },
        "body": {
          "customer_info": {
            "name": "Pedro Costa",
            "phone": "+5511666666666"
          },
          "appointment_type": "Consulta Geral",
          "datetime": "2025-01-25T14:00:00Z",
          "duration": 30
        }
      },
      "response": {
        "status": 422,
        "body": {
          "type": "https://api.atendeai.com.br/errors/appointment-conflict",
          "title": "Conflito de Agendamento",
          "status": 422,
          "detail": "Já existe um agendamento neste horário",
          "instance": "/appointments",
          "conflict_datetime": "2025-01-25T14:00:00Z",
          "existing_appointment_id": "550e8400-e29b-41d4-a716-446655440070"
        }
      }
    },
    {
      "name": "Erro - Google Calendar Não Integrado",
      "request": {
        "method": "POST",
        "url": "/appointments",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer token_sem_google"
        },
        "body": {
          "customer_info": {
            "name": "Ana Lima",
            "phone": "+5511555555555"
          },
          "appointment_type": "Consulta Geral",
          "datetime": "2025-01-26T10:00:00Z"
        }
      },
      "response": {
        "status": 422,
        "body": {
          "type": "https://api.atendeai.com.br/errors/google-calendar-not-integrated",
          "title": "Google Calendar Não Integrado",
          "status": 422,
          "detail": "É necessário integrar o Google Calendar antes de criar agendamentos",
          "instance": "/appointments"
        }
      }
    },
    {
      "name": "Erro - Autorização Google Expirada",
      "request": {
        "method": "GET",
        "url": "/google/events?calendar_id=primary",
        "headers": {
          "Authorization": "Bearer token_google_expirado"
        }
      },
      "response": {
        "status": 422,
        "body": {
          "type": "https://api.atendeai.com.br/errors/google-oauth-expired",
          "title": "Autorização Google Expirada",
          "status": 422,
          "detail": "A autorização do Google Calendar expirou. É necessário reautorizar",
          "instance": "/google/events",
          "reauthorization_required": true
        }
      }
    }
  ]
}
